"use strict";(self.webpackChunksupplier_web=self.webpackChunksupplier_web||[]).push([[97],{5097:(pt,f,p)=>{p.r(f),p.d(f,{CartModule:()=>ut});var l=p(8583),t=p(7716),g=p(103),v=p(7996),_=p(7193),T=p(8131),q=p(2290),h=p(487);const C=["qtyInput"];function A(i,s){if(1&i&&t._UZ(0,"i",33),2&i){const e=t.oxw().$implicit;t.s9C("ngbPopover",e.product.name),t.Q6J("placement","auto")("container","body")}}function x(i,s){if(1&i&&(t.TgZ(0,"td"),t.TgZ(1,"h2",34),t._uU(2),t.qZA(),t.qZA()),2&i){const e=t.oxw().$implicit,o=t.oxw();t.xp6(2),t.hij("RS:",e.product.price*e.quantity+o.shippingCost,"")}}function y(i,s){if(1&i&&(t.TgZ(0,"td"),t.TgZ(1,"h2",34),t._uU(2),t.qZA(),t.qZA()),2&i){const e=t.oxw().$implicit,o=t.oxw();t.xp6(2),t.hij("RS:",e.product.discountedPrice*e.quantity+o.shippingCost,"")}}const I=function(i){return{background:i}},b=function(i){return[i]},k=function(i,s){return{va:i,prdt:s}};function S(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"td",19),t._UZ(2,"span",20),t._uU(3),t.ALo(4,"slice"),t.YNc(5,A,1,3,"i",21),t.qZA(),t.TgZ(6,"td"),t.TgZ(7,"h2"),t._uU(8),t.qZA(),t.qZA(),t.TgZ(9,"td"),t.TgZ(10,"h2"),t._uU(11),t.qZA(),t.qZA(),t.TgZ(12,"td"),t.TgZ(13,"h2"),t._uU(14),t.qZA(),t.qZA(),t.TgZ(15,"td"),t.TgZ(16,"div",22),t.TgZ(17,"div",23),t.NdJ("click",function(){const r=t.CHM(e),n=r.$implicit,a=r.index;return t.oxw().handleQuantityChange("-",n,a)}),t.TgZ(18,"button",24),t._uU(19,"-"),t.qZA(),t.qZA(),t._UZ(20,"input",25,26),t.TgZ(22,"div",27),t.NdJ("click",function(){const r=t.CHM(e),n=r.$implicit,a=r.index;return t.oxw().handleQuantityChange("+",n,a)}),t.TgZ(23,"button",24),t._uU(24,"+"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(25,x,3,1,"td",28),t.YNc(26,y,3,1,"td",28),t.TgZ(27,"td"),t.TgZ(28,"a",29),t._UZ(29,"i",30),t.qZA(),t.TgZ(30,"button",31),t.NdJ("click",function(){const n=t.CHM(e).$implicit,a=t.oxw(),c=t.MAs(47);return a.removeCartItem(n,c)}),t._UZ(31,"i",32),t.qZA(),t.qZA(),t.qZA()}if(2&i){const e=s.$implicit,o=s.index,r=t.oxw();t.xp6(2),t.Q6J("ngStyle",t.VKq(16,I,e.product.hexCode)),t.xp6(1),t.hij(" ",e.product.name.length<=15?e.product.name:t.Dn7(4,12,e.product.name,0,15)+"...",""),t.xp6(2),t.Q6J("ngIf",e.product.name&&e.product.name.length>15),t.xp6(3),t.Oqu(e.product.price),t.xp6(3),t.Oqu(e.product.discountedPrice?e.product.discountedPrice:0),t.xp6(3),t.Oqu(r.shippingCost),t.xp6(6),t.Q6J("id","qtyInput"+o)("value",null==e?null:e.quantity),t.xp6(5),t.Q6J("ngIf",!e.product.discountedPrice),t.xp6(1),t.Q6J("ngIf",e.product.discountedPrice),t.xp6(2),t.Q6J("routerLink",t.VKq(18,b,r._httpService.apiRoutes.Product.ProductDetail))("queryParams",t.WLB(20,k,null==e||null==e.product?null:e.product.variantId,(null==e||null==e.product?null:e.product.slug)+"-"+(null==e||null==e.product?null:e.product.id)))}}function U(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div",35),t.TgZ(1,"div",36),t.TgZ(2,"h5",37),t._uU(3,"Are you sure you want to Delete?"),t.qZA(),t.qZA(),t.TgZ(4,"div",38),t.TgZ(5,"button",39),t.NdJ("click",function(){return t.CHM(e).$implicit.close("cancel click")}),t._uU(6,"No"),t.qZA(),t.TgZ(7,"button",40),t.NdJ("click",function(){return t.CHM(e),t.oxw().deleteCartItemconfirm()}),t._uU(8,"Yes"),t.qZA(),t.qZA(),t.qZA()}}let N=(()=>{class i{constructor(e,o,r,n){this._cartService=e,this._modalService=o,this._httpService=r,this.toastr=n,this.obj={},this.cartItems=[],this.quantity=1,this.shippingCost=0,this.cityId=64,this.total=0,this.bulkInventory=new Array,this.qtyInputList={},this.orderItem={}}ngOnInit(){this.getCityShippingCostForOrder()}calculateCartTotal(){this._cartService.getItems().subscribe(e=>{this.cartItems=e,console.log(this.cartItems),this.total=this.cartItems.reduce((o,r)=>o+(r.product.discountedPrice?r.product.discountedPrice*r.quantity:r.product.price*r.quantity)+this.shippingCost,0)})}getCityShippingCostForOrder(){this._httpService.GetData(this._httpService.apiUrls.Customer.Order.GetCityShippingCost+`?id=${this.cityId}`).then(e=>{this.response=e,this.response.status==g.GL.OK&&(this.cityShippingCost=this.response.resultData,this.shippingCost=this.cityShippingCost[0].cost,this.calculateCartTotal())})}handleQuantityChange(e,o,r){this.bulkInventory=o.product.bulkInventory;let n=this.qtyInputList.toArray()[r].nativeElement.value;if("+"==e){if(n>=o.product.stockQuantity)return this.toastr.warning("You can only buy available stock quantity ","Sorry",{timeOut:5e3}),void(this.quantity=o.product.stockQuantity);n++;for(let a of this.bulkInventory)if(a.minQuantity<=n&&n<=a.maxQuantity){let c=a.bulkPrice/100*a.bulkDiscount;c=a.bulkPrice-c,o.product.discountedPrice=c;break}this._cartService.changeItemQuantity(o,n)}else{if(n<2)return;if(n--,this.bulkInventory.length>0)for(let a of this.bulkInventory){if(a.minQuantity<=n&&n<=a.maxQuantity){o.product.discountedPrice=a.bulkPrice-a.bulkPrice/100*a.bulkDiscount;break}if(a.maxQuantity>n){o.product.discountedPrice=o.product.actualVarientPrice;break}}this._cartService.changeItemQuantity(o,n)}}removeCartItem(e,o){this._modalService.open(o,{backdrop:"static",keyboard:!1}),this.orderItem=e}deleteCartItemconfirm(){this._cartService.removeItem(this.orderItem),this._modalService.dismissAll()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(v.N),t.Y36(_.FF),t.Y36(T.v),t.Y36(q._W))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-viewcart"]],viewQuery:function(e,o){if(1&e&&t.Gf(C,5,t.SBq),2&e){let r;t.iGM(r=t.CRH())&&(o.qtyInputList=r)}},decls:48,vars:6,consts:[[1,"breadcrumb-section","py-5"],[1,"container"],[1,"row"],[1,"col-sm-6"],[1,"page-title"],[1,"wishlist-section","section-b-space"],[1,"col-sm-12","table-responsive-xs"],[1,"table","cart-table"],[1,"table-head"],["width","30%","scope","col"],["width","10%","scope","col"],["width","20%","scope","col"],[4,"ngFor","ngForOf"],[1,"table-responsive-md"],[1,"row","wishlist-buttons"],[1,"col-12","d-flex","justify-content-between"],["routerLink","",1,"btn","btn-solid"],["routerLink","/cart/checkout",1,"btn","btn-solid"],["removecartitem",""],[1,"d-flex","align-items-center"],["id","variant-box",1,"me-1",3,"ngStyle"],["class","fa fa-eye","placement","top","popoverTitle","Product Name",3,"ngbPopover","placement","container",4,"ngIf"],["id","quantity-meter",1,"input-group"],[1,"input-group-append",3,"click"],["type","button",1,"px-3","fs-6","input-group-text"],["type","number","disabled","",1,"form-control","text-center",3,"id","value"],["qtyInput",""],[1,"input-group-prepend",3,"click"],[4,"ngIf"],[1,"icon",3,"routerLink","queryParams"],[1,"ti-eye"],["type","button",1,"btn","icon",3,"click"],[1,"ti-close"],["placement","top","popoverTitle","Product Name",1,"fa","fa-eye",3,"ngbPopover","placement","container"],[1,"text-danger"],[1,"modal-content"],[1,"modal-body"],[2,"color","#636363","font-size","24px"],[1,"modal-footer","justify-content-center"],["type","button",1,"btn","btn-theme","btn-sm",3,"click"],["type","button",1,"btn","btn-sm","btn-theme",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.TgZ(4,"div",4),t.TgZ(5,"h2"),t._uU(6,"Viewcart"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(7,"section",5),t.TgZ(8,"div",1),t.TgZ(9,"div",2),t.TgZ(10,"div",6),t.TgZ(11,"table",7),t.TgZ(12,"thead"),t.TgZ(13,"tr",8),t.TgZ(14,"th",9),t._uU(15,"product name"),t.qZA(),t.TgZ(16,"th",10),t._uU(17,"price"),t.qZA(),t.TgZ(18,"th",11),t._uU(19,"Discounted price"),t.qZA(),t.TgZ(20,"th",11),t._uU(21,"Shipping Cost"),t.qZA(),t.TgZ(22,"th",10),t._uU(23,"quantity"),t.qZA(),t.TgZ(24,"th",10),t._uU(25,"total"),t.qZA(),t.TgZ(26,"th",11),t._uU(27,"action"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(28,"tbody"),t.YNc(29,S,32,23,"tr",12),t.qZA(),t.qZA(),t.TgZ(30,"div",13),t.TgZ(31,"table",7),t.TgZ(32,"tfoot"),t.TgZ(33,"tr"),t.TgZ(34,"td"),t._uU(35,"total price :"),t.qZA(),t.TgZ(36,"td"),t.TgZ(37,"h2"),t._uU(38),t.ALo(39,"number"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(40,"div",14),t.TgZ(41,"div",15),t.TgZ(42,"a",16),t._uU(43,"continue shopping"),t.qZA(),t.TgZ(44,"a",17),t._uU(45,"check out"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(46,U,9,0,"ng-template",null,18,t.W1O)),2&e&&(t.xp6(29),t.Q6J("ngForOf",o.cartItems),t.xp6(9),t.hij("Rs.",t.Dn7(39,2,o.total,"1.0","en-US"),""))},directives:[l.sg,h.yS,l.PC,l.O5,_.o8],pipes:[l.JJ,l.OU],styles:[""]}),i})();var u=p(665),w=p(2122),P=p(9866);function J(i,s){if(1&i&&(t.TgZ(0,"span",35),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e._httpService.validationMessage.Shippingdetails.FieldRequridError)}}function O(i,s){if(1&i&&(t.TgZ(0,"span",35),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.Oqu(e._httpService.validationMessage.Shippingdetails.FieldPatternError)}}function Q(i,s){1&i&&(t.TgZ(0,"span",35),t._uU(1,"Invalid Input"),t.qZA())}function Y(i,s){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,O,2,1,"span",34),t.YNc(2,Q,2,0,"span",34),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",null==e.f.firstName.errors?null:e.f.firstName.errors.pattern),t.xp6(1),t.Q6J("ngIf",null==e.f.firstName.errors?null:e.f.firstName.errors.minlength)}}function F(i,s){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,J,2,1,"span",34),t.YNc(2,Y,3,2,"div",21),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",(null==e.f.firstName.errors?null:e.f.firstName.errors.required)&&e.submitted),t.xp6(1),t.Q6J("ngIf",e.f.firstName.invalid&&(e.f.firstName.touched||e.f.firstName.dirty))}}function L(i,s){if(1&i&&(t.TgZ(0,"span",35),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e._httpService.validationMessage.Shippingdetails.FieldRequridError)}}function M(i,s){if(1&i&&(t.TgZ(0,"span",35),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.Oqu(e._httpService.validationMessage.Shippingdetails.FieldPatternError)}}function D(i,s){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,M,2,1,"span",34),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",null==e.f.lastName.errors?null:e.f.lastName.errors.minlength)}}function V(i,s){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,L,2,1,"span",34),t.YNc(2,D,2,1,"div",21),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",(null==e.f.lastName.errors?null:e.f.lastName.errors.required)&&e.submitted),t.xp6(1),t.Q6J("ngIf",e.f.lastName.invalid&&(e.f.lastName.touched||e.f.lastName.dirty))}}function E(i,s){if(1&i&&(t.TgZ(0,"span",35),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e._httpService.validationMessage.Shippingdetails.FieldRequridError)}}function R(i,s){if(1&i&&(t.TgZ(0,"span",35),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e._httpService.validationMessage.Shippingdetails.FieldPatternError)}}function G(i,s){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,E,2,1,"span",34),t.YNc(2,R,2,1,"span",34),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",(null==e.f.PhoneNumber.errors?null:e.f.PhoneNumber.errors.required)&&e.submitted),t.xp6(1),t.Q6J("ngIf",(null==e.f.PhoneNumber.errors?null:e.f.PhoneNumber.errors.minlength)&&e.submitted)}}function j(i,s){if(1&i&&(t.TgZ(0,"span",35),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e._httpService.validationMessage.Shippingdetails.FieldRequridError)}}function $(i,s){1&i&&(t.TgZ(0,"span",35),t._uU(1,"Invalid Input"),t.qZA())}function B(i,s){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,$,2,0,"span",34),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",null==e.f.email.errors?null:e.f.email.errors.pattern)}}function H(i,s){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,j,2,1,"span",34),t.YNc(2,B,2,1,"div",21),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",(null==e.f.email.errors?null:e.f.email.errors.required)&&e.submitted),t.xp6(1),t.Q6J("ngIf",e.f.email.invalid&&(e.f.email.touched||e.f.email.dirty))}}function z(i,s){if(1&i&&(t.TgZ(0,"option",36),t._uU(1),t.qZA()),2&i){const e=s.$implicit;t.s9C("value",e.id),t.xp6(1),t.Oqu(e.value)}}function K(i,s){if(1&i&&(t.TgZ(0,"span",35),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e._httpService.validationMessage.Shippingdetails.FieldRequridError)}}function W(i,s){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,K,2,1,"span",34),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",(null==e.f.City.errors?null:e.f.City.errors.required)&&e.submitted)}}function X(i,s){if(1&i&&(t.TgZ(0,"span",35),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e._httpService.validationMessage.Shippingdetails.FieldRequridError)}}function tt(i,s){if(1&i&&(t.TgZ(0,"span",35),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.Oqu(e._httpService.validationMessage.Shippingdetails.FieldPatternError)}}function et(i,s){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,tt,2,1,"span",34),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",null==e.f.Address.errors?null:e.f.Address.errors.minlength)}}function it(i,s){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,X,2,1,"span",34),t.YNc(2,et,2,1,"div",21),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",(null==e.f.Address.errors?null:e.f.Address.errors.required)&&e.submitted),t.xp6(1),t.Q6J("ngIf",e.f.Address.invalid&&(e.f.Address.touched||e.f.Address.dirty))}}function ot(i,s){1&i&&(t.TgZ(0,"span",35),t._uU(1,"Input is required."),t.qZA())}function nt(i,s){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,ot,2,0,"span",34),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",(null==e.f.orderMessage.errors?null:e.f.orderMessage.errors.required)&&e.submitted)}}const rt=function(i){return{background:i}};function st(i,s){if(1&i&&(t.TgZ(0,"li",48),t.TgZ(1,"div",49),t._UZ(2,"small",50),t._uU(3),t.ALo(4,"slice"),t.qZA(),t.TgZ(5,"span"),t._uU(6),t.qZA(),t.qZA()),2&i){const e=s.$implicit;t.xp6(2),t.Q6J("ngStyle",t.VKq(7,rt,e.product.hexCode)),t.xp6(1),t.hij(" ",e.product.name.length<=35?e.product.name:t.Dn7(4,3,e.product.name,0,35)+"..."," "),t.xp6(3),t.Oqu(e.quantity+" X RS "+(e.product.discountedPrice?e.product.discountedPrice:e.product.price)+" = "+e.quantity*(e.product.discountedPrice?e.product.discountedPrice:e.product.price))}}function ct(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div",13),t.TgZ(1,"div",37),t.TgZ(2,"div",38),t.TgZ(3,"div",39),t.TgZ(4,"div"),t._uU(5,"Product "),t.TgZ(6,"span"),t._uU(7,"Total"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(8,"ul",40),t.YNc(9,st,7,9,"li",41),t.qZA(),t.TgZ(10,"ul",42),t.TgZ(11,"li"),t._uU(12,"Subtotal "),t.TgZ(13,"span",43),t._uU(14),t.ALo(15,"number"),t.qZA(),t.qZA(),t.TgZ(16,"li"),t._uU(17,"Promotions "),t.TgZ(18,"span",43),t._uU(19),t.ALo(20,"number"),t.qZA(),t.qZA(),t.TgZ(21,"li"),t._uU(22,"Estimated Shipping Cost "),t.TgZ(23,"span",43),t._uU(24),t.ALo(25,"number"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(26,"ul",44),t.TgZ(27,"li"),t._uU(28,"Total "),t.TgZ(29,"span",43),t._uU(30),t.ALo(31,"number"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(32,"div",45),t.TgZ(33,"div",46),t.TgZ(34,"button",47),t.NdJ("click",function(){return t.CHM(e),t.oxw().checkOut()}),t._uU(35,"Place Order"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&i){const e=t.oxw();t.xp6(9),t.Q6J("ngForOf",e.cartItems),t.xp6(5),t.hij("Rs.",t.Dn7(15,5,e.subTotal,"1.0","en-US"),""),t.xp6(5),t.hij("-",t.Dn7(20,9,e.promotionsTotal,"1.0","en-US"),""),t.xp6(5),t.hij("+",t.Dn7(25,13,e.totalShippingCost,"1.0","en-US"),""),t.xp6(6),t.hij("Rs.",t.Dn7(31,17,e.subTotal-e.promotionsTotal+e.totalShippingCost,"1.0","en-US"),"")}}const at=[{path:"viewcart",component:N},{path:"checkout",component:(()=>{class i{constructor(e,o,r,n,a,c){this._toastr=e,this._cartService=o,this.formBuilder=r,this._httpService=n,this._messageService=a,this.Loader=c,this.cartItems=[],this.subTotal=0,this.shipingdetails="",this.customerId=0,this.userId="",this.cityList=[],this.promotionList=[],this.promotionsTotal=0,this.submitted=!1,this.isCartEmpty=!1,this.userRole="",this.cityId=64,this.shippingCost=0,this.totalShippingCost=0,this.appValForm={},this.loggedUserDetails={},this.cityShippingCost={},this.shippingdata=new g.OR}ngOnInit(){this.appValForm=this.formBuilder.group({firstName:["",[u.kI.required]],lastName:["",[u.kI.required]],PhoneNumber:["",[u.kI.required]],email:["",[u.kI.required]],Address:["",[u.kI.required]],City:["",[u.kI.required]],orderMessage:["",[u.kI.required]]});var e=this._httpService.decodedToken();this.customerId=e.Id,this.userId=e.UserId,this.userRole=e.Role,this.getLoggedUserDetails(this.userRole,this.userId),this.getAllCities()}getCityShippingCostForOrder(){this._httpService.GetData(this._httpService.apiUrls.Customer.Order.GetCityShippingCost+`?id=${this.cityId}`).then(e=>{this.response=e,this.response.status==g.GL.OK&&(this.cityShippingCost=this.response.resultData,this.shippingCost=this.cityShippingCost[0].cost,this.totalShippingCost=this.cityShippingCost[0].cost,this.getCartItems(),this.Loader.hide())})}getPromotionsOnCategory(){this.promotionList=[],this.promotionsTotal=0,this.cartItems.forEach(e=>{this._httpService.GetData1(this._httpService.apiUrls.Promotion.GetPromotionsBySuplierId+`?supplierId=${e.product.supplierId}`).then(o=>{let r=o.resultData;r&&r.forEach(n=>{(e.product.categoryId==n.categoryId&&e.product.subCategoryId==n.subCategoryId&&e.product.categoryGroupId==n.categoryGroupId||e.product.categoryId==n.categoryId&&e.product.subCategoryId==n.subCategoryId&&0==e.product.categoryGroupId||e.product.categoryId==n.categoryId&&0==e.product.subCategoryId&&0==e.product.categoryGroupId)&&(this.promotionList.push({promotionId:n.promotionId,amount:n.amount,productId:e.product.id}),this.promotionsTotal+=n.amount)})})}),console.log(this.promotionList)}getCartItems(){this._cartService.getItems().subscribe(e=>{this.isCartEmpty=e.length>0,this.totalShippingCost=this.totalShippingCost*e.length,console.log(this.totalShippingCost),this.cartItems=e,this.getPromotionsOnCategory(),this.subTotal=this.cartItems.reduce((o,r)=>{var n;return o+((null===(n=r.product)||void 0===n?void 0:n.discountedPrice)>0?r.product.discountedPrice*r.quantity:r.product.price*r.quantity)},0)})}getLoggedUserDetails(e,o){this._httpService.GetData(this._httpService.apiUrls.Customer.GetUserDetailsByUserRole+`?userId=${o}&userRole=${e}`,!0).then(r=>{this.response=r,this.response.status==g.GL.OK&&(this.loggedUserDetails=this.response.resultData,console.log(this.loggedUserDetails),this.shippingdata=this.loggedUserDetails,this.shippingdata.PhoneNumber=this.loggedUserDetails.mobileNumber,this.appValForm.patchValue(this.shippingdata),this.getCityShippingCostForOrder())},r=>{this._httpService.Loader.show(),console.log(r)})}checkOut(){var e;if(this.submitted=!0,this.appValForm.valid){this.shipingdetails=this.appValForm.value,this.shipingdetails.City=Number(this.shipingdetails.City);const o=Number(null===(e=this._httpService.decodedToken())||void 0===e?void 0:e.Id);if(o>0){let r=new Array,n=new Array;this.cartItems.forEach(c=>{n.some(Z=>Z.supplierId==c.product.supplierId)||n.push({supplierId:c.product.supplierId,firebaseClientId:c.product.firebaseClientId});let[d]=this.promotionList.filter(Z=>Z.productId==c.product.id);r.push({supplierId:c.product.supplierId,variantId:null==c?void 0:c.product.variantId,productId:null==c?void 0:c.product.id,quantity:c.quantity,price:c.product.price,discount:null==c?void 0:c.product.discount,promotionId:d?d.promotionId:0,promotionAmount:d?d.amount:0,discountedPrice:c.product.discountedPrice,shippingAmount:this.shippingCost})});let a={isFromWeb:!0,orderTotal:this.subTotal-this.promotionsTotal,customerId:o,orderStatus:g.iF.Inprogress,orderMessage:this.shipingdetails.orderMessage,items:r,shippingDetails:this.shipingdetails,totalShippingCost:this.totalShippingCost,supplierIdArr:n};console.log(a),this._httpService.PostData(this._httpService.apiUrls.Supplier.Product.PlaceOrder,a).then(c=>{let d=c;200==d.status&&(n.forEach(m=>{m.firebaseClientId&&this._messageService.sendMessage("Order","You received an order",m.firebaseClientId)}),this._cartService.clearCartItems(),this._toastr.success(d.message,"Success"),this._httpService.NavigateToRoute("/user/payment/"+d.resultData))})}else this._toastr.error("Something went wrong","Error")}}getAllCities(){this._httpService.get(this._httpService.apiUrls.Supplier.City.getCityList).subscribe(e=>{this.cityList=e})}get f(){return this.appValForm.controls}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(q._W),t.Y36(v.N),t.Y36(u.qu),t.Y36(T.v),t.Y36(w.o),t.Y36(P.t2))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-checkout"]],decls:85,vars:12,consts:[[1,"breadcrumb-section"],[1,"container"],[1,"row"],[1,"col-sm-6"],[1,"page-title"],["aria-label","breadcrumb",1,"theme-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],[3,"routerLink"],[1,"section-b-space"],[1,"checkout-page"],[1,"checkout-form"],[3,"formGroup"],[1,"col-lg-6","col-sm-12","col-xs-12"],[1,"checkout-title"],[1,"row","check-out"],["disabled","",1,"row","check-out"],[1,"form-group","col-md-6","col-sm-6","col-xs-12"],[1,"field-label"],[2,"color","red"],["type","text","name","field-name","formControlName","firstName","value","","placeholder","First name","minlength","3","maxlength","40",3,"keypress"],[4,"ngIf"],["type","text","name","field-name","formControlName","lastName","value","","placeholder","Last name","minlength","3","maxlength","40",3,"keypress"],["disabled",""],["type","text","name","field-name","value","","minlength","11","maxlength","11","formControlName","PhoneNumber","placeholder","Phone Number",3,"keypress"],["type","text","name","field-name","value","","formControlName","email","placeholder","Email Address","pattern","^[a-zA-Z0-9.!#$%&\u2019*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)+$"],[1,"form-group","col-md-12","col-sm-12","col-xs-12"],["formControlName","City"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],[1,"row","check-out","m-top-15"],["type","text","name","field-name","value","","formControlName","Address","placeholder","Address","minlength","3","maxlength","50"],["formControlName","orderMessage","rows","5",3,"keypress"],["class","col-lg-6 col-sm-12 col-xs-12",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"text-danger"],[3,"value"],[1,"checkout-details"],[1,"order-box"],[1,"title-box"],[1,"qty"],["class","d-flex align-items-center justify-content-between",4,"ngFor","ngForOf"],[1,"sub-total"],[1,"count"],[1,"total"],[1,"payment-box"],[1,"text-end"],["type","button",1,"btn-solid","btn",3,"click"],[1,"d-flex","align-items-center","justify-content-between"],[1,"d-flex","align-items-center"],["id","variant-box",1,"me-1",3,"ngStyle"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.TgZ(4,"div",4),t.TgZ(5,"h2"),t._uU(6,"Check-out"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(7,"div",3),t.TgZ(8,"nav",5),t.TgZ(9,"ol",6),t.TgZ(10,"li",7),t.TgZ(11,"a",8),t._uU(12,"Home"),t.qZA(),t.qZA(),t.TgZ(13,"li",7),t.TgZ(14,"a",8),t._uU(15,"View Cart"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(16,"section",9),t.TgZ(17,"div",1),t.TgZ(18,"div",10),t.TgZ(19,"div",11),t.TgZ(20,"form",12),t.TgZ(21,"div",2),t.TgZ(22,"div",13),t.TgZ(23,"div",14),t.TgZ(24,"h3"),t._uU(25,"Shipping Details"),t.qZA(),t.qZA(),t.TgZ(26,"div",15),t.TgZ(27,"fieldset",16),t.TgZ(28,"div",17),t.TgZ(29,"div",18),t._uU(30,"First Name"),t.TgZ(31,"span",19),t._uU(32,"*"),t.qZA(),t.qZA(),t.TgZ(33,"input",20),t.NdJ("keypress",function(n){return o._httpService.charOnly(n)}),t.qZA(),t.YNc(34,F,3,2,"div",21),t.qZA(),t.TgZ(35,"div",17),t.TgZ(36,"div",18),t._uU(37,"Last Name"),t.TgZ(38,"span",19),t._uU(39,"*"),t.qZA(),t.qZA(),t.TgZ(40,"input",22),t.NdJ("keypress",function(n){return o._httpService.charOnly(n)}),t.qZA(),t.YNc(41,V,3,2,"div",21),t.qZA(),t.qZA(),t.TgZ(42,"div",15),t.TgZ(43,"div",17),t.TgZ(44,"fieldset",23),t.TgZ(45,"div",18),t._uU(46,"Phone Number"),t.TgZ(47,"span",19),t._uU(48,"*"),t.qZA(),t.qZA(),t.TgZ(49,"input",24),t.NdJ("keypress",function(n){return o._httpService.numberOnly(n)}),t.qZA(),t.YNc(50,G,3,2,"div",21),t.qZA(),t.qZA(),t.TgZ(51,"div",17),t.TgZ(52,"div",18),t._uU(53,"Email Address"),t.TgZ(54,"span",19),t._uU(55,"*"),t.qZA(),t.qZA(),t._UZ(56,"input",25),t.YNc(57,H,3,2,"div",21),t.qZA(),t.qZA(),t.TgZ(58,"fieldset",15),t.TgZ(59,"div",26),t.TgZ(60,"div",18),t._uU(61,"City"),t.TgZ(62,"span",19),t._uU(63,"*"),t.qZA(),t.qZA(),t.TgZ(64,"select",27),t.TgZ(65,"option",28),t._uU(66,"Select City"),t.qZA(),t.YNc(67,z,2,2,"option",29),t.qZA(),t.YNc(68,W,2,1,"div",21),t.qZA(),t.qZA(),t.TgZ(69,"fieldset",30),t.TgZ(70,"div",26),t.TgZ(71,"div",18),t._uU(72,"Address"),t.TgZ(73,"span",19),t._uU(74,"*"),t.qZA(),t.qZA(),t._UZ(75,"input",31),t.YNc(76,it,3,2,"div",21),t.qZA(),t.TgZ(77,"div",26),t.TgZ(78,"div",18),t._uU(79,"Leave your Message"),t.TgZ(80,"span",19),t._uU(81,"*"),t.qZA(),t.qZA(),t.TgZ(82,"textarea",32),t.NdJ("keypress",function(n){return o._httpService.charOnly(n)}),t.qZA(),t.YNc(83,nt,2,1,"div",21),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(84,ct,36,21,"div",33),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(11),t.Q6J("routerLink","/"),t.xp6(3),t.Q6J("routerLink",o._httpService.apiRoutes.Cart.viewcart),t.xp6(6),t.Q6J("formGroup",o.appValForm),t.xp6(14),t.Q6J("ngIf",null==o.f.firstName?null:o.f.firstName.errors),t.xp6(7),t.Q6J("ngIf",null==o.f.lastName?null:o.f.lastName.errors),t.xp6(9),t.Q6J("ngIf",null==o.f.PhoneNumber?null:o.f.PhoneNumber.errors),t.xp6(7),t.Q6J("ngIf",null==o.f.email?null:o.f.email.errors),t.xp6(10),t.Q6J("ngForOf",o.cityList),t.xp6(1),t.Q6J("ngIf",null==o.f.City?null:o.f.City.errors),t.xp6(8),t.Q6J("ngIf",null==o.f.Address?null:o.f.Address.errors),t.xp6(7),t.Q6J("ngIf",null==o.f.orderMessage?null:o.f.orderMessage.errors),t.xp6(1),t.Q6J("ngIf",o.isCartEmpty))},directives:[h.yS,u._Y,u.JL,u.sg,u.Fj,u.JJ,u.u,u.wO,u.nD,l.O5,u.c5,u.EJ,u.YN,u.Kr,l.sg,l.PC],pipes:[l.JJ,l.OU],styles:[".txtclr-red[_ngcontent-%COMP%]{color:red}.m-top-15[_ngcontent-%COMP%]{margin-top:15px}"]}),i})()}];let ut=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[l.ez,u.UX,_.IJ,h.Bz.forChild(at)],h.Bz]}),i})()}}]);